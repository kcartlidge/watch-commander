var WatchCommander=function(){};WatchCommander=function(a){var b=this,c=[],d=[];for(key in b)b.hasOwnProperty(key)&&("function"==typeof b[key]?d.push(key):c.push(key));b.__WatchCommander={selector:a,properties:c,virtuals:d,bindings:[],invalids:[],attribute:"wc"},b.stopWatching=function(){for(var a=b.__WatchCommander.bindingCount,c=0;c<a;c++){var d=b.__WatchCommander.bindings[c],e=$(d.selector);e.off("change")}delete b.__WatchCommander,delete b.set,delete b.get,delete b.getOptionText,delete b.trigger,delete b.isValid,delete b.stopWatching},b.set=function(a,b){var c=this;if(c.__WatchCommander.properties.indexOf(a)>-1){var d=c.get(a);return c[a]=b,actualNewValue=c.get(a),actualNewValue!=d&&WatchCommander.applyBindings.call(c,a),"undefined"!=typeof c.onChange&&c.onChange.apply(c,[a,d,actualNewValue]),actualNewValue}return null},b.get=function(a){var b=this,c=null;return b.__WatchCommander.properties.indexOf(a)>-1?c=b[a]:b.__WatchCommander.virtuals.indexOf(a)>-1?c=b[a]():"function"==typeof b[a]&&(c=b[a]()),c},"function"!=typeof b.showValidity&&(b.showValidity=function(a,b,c){c?$(b).removeClass("invalid"):$(b).addClass("invalid")}),"function"!=typeof b.isValid&&(b.isValid=function(a){return"undefined"==typeof b.__WatchCommander.invalids||("undefined"==typeof a||null==a||""==a?0==b.__WatchCommander.invalids.length:b.__WatchCommander.invalids.indexOf(a)==-1)}),b.getOptionText=function(a,b){for(var c=this,d="",e=c[b](),f=e.length,g=0;g<f;g++)e[g].value==a&&(d=e[g].text);return d},b.redraw=function(){WatchCommander.applyBindings.call(b,!0)};var e=$(a).find("["+b.__WatchCommander.attribute+"]");e.each(function(){var a=$(this),c="#"+a[0].id;if(1==c.length&&(c=WatchCommander.makeId(),a[0].id=c,c="#"+c),1!=c.length){for(var d=a.attr(b.__WatchCommander.attribute).split(","),e=d.length,f=0;f<e;f++){var g=d[f],h=g.split(":"),i={selector:c,propertyName:h[1],accessor:h[0]};b.__WatchCommander.bindings.push(i),b.__WatchCommander.bindingCount=b.__WatchCommander.bindings.length}$(c).off("change").on("change",function(a){var c=b.get(i.propertyName),d=$(a.target).val();c!=d&&b.set(i.propertyName,d)})}}),WatchCommander.applyBindings.call(b)},WatchCommander.makeId=function(){return"wc_"+"xxxxxxxxxxxxxxxxxxxxxxxx".replace(/x/g,function(a){return(16*Math.random()|0).toString(16)}).toLowerCase()},WatchCommander.applyBindings=function(a,b){for(var c=this,d=b||"undefined"==typeof a||null==a||""==a,e=c.__WatchCommander.bindingCount,f=0;f<e;f++){var g=c.__WatchCommander.bindings[f],h=c.__WatchCommander.virtuals.indexOf(g.propertyName)>-1;(d||g.propertyName==a||h)&&WatchCommander.bind.call(c,g,b)}},WatchCommander.bind=function(a,b){var e,c=this,d=$(a.selector);switch(a.accessor){case"val":case"text":case"html":e=c.get(a.propertyName);var f=d[a.accessor]();(f!==e||b)&&d[a.accessor](e);break;case"toggle":case"addClass":case"removeClass":e=c.get(a.propertyName),d[a.accessor](e);break;case"class":e=c.get(a.propertyName),d.removeClass(),d.addClass(e);break;case"options":var g=d.val(),h=c.get(a.propertyName);null==h&&(h=[]);var i=h.length;d.find("option").remove();for(var j="",k=0;k<i;k++){var l="<option value='"+h[k].value+"'>"+h[k].text+"</option>";j+=l}d.append(j),c.set(a.propertyName,g),e=c.get(a.propertyName)}var m=!0,n=c.__WatchCommander.invalids.indexOf(a.propertyName);n>-1&&c.__WatchCommander.invalids.splice(n,1);var o="undefined"!=typeof c.RequiredFields;o&&c.RequiredFields.indexOf(a.propertyName)>-1&&("undefined"!=typeof e&&null!=e&&""!=e.toString().trim()||(m=!1));var p="undefined"!=typeof c.Validation;p&&"undefined"!=typeof c.Validation[a.propertyName]&&("undefined"==typeof e||null==e?m=!1:c.Validation[a.propertyName].call(c,e)||(m=!1)),m||c.__WatchCommander.invalids.push(a.propertyName),c.showValidity(a.propertyName,a.selector,m)};